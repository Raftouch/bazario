{% extends 'main/base.html' %}
{% load static %}

{% block title %}Shop{% endblock title %}

{% block content %}
<div class="flex flex-col md:flex-row gap-8">
    <aside class="w-full md:w-1/4 bg-gray-100 p-4 rounded">
        <h3 class="text-lg font-semibold mb-4">Categories</h3>
        <ul class="space-y-2">
            <li>
                <a href="{% url 'main:product_list' %}"
                   class="{% if not category %}text-blue-600 font-semibold{% else %}text-gray-700{% endif %} hover:underline">
                    All products
                </a>
            </li>
            {% for cat in categories %}
                <li>
                    <a href="{{ cat.get_absolute_url }}"
                       class="{% if category.slug == cat.slug %}text-blue-600 font-semibold{% else %}text-gray-700{% endif %} hover:underline">
                        {{ cat.name }}
                    </a>
                </li>
            {% endfor %}
        </ul>
    </aside>

    <section class="w-full md:w-3/4">
        <h3 class="text-2xl font-bold mb-6">
            {% if category %} {{ category.name }} {% else %} Products {% endif %}
        </h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for product in products %}
                <div class="border rounded shadow hover:shadow-md transition p-4 flex flex-col items-center text-center">
                    <a href="{{ product.get_absolute_url }}">
                        <img src="{% if product.image %}{{ product.image.url }}{% else %}{% static 'images/noimage.png' %}{% endif %}"
                             alt="Image du produit"
                             class="h-48 object-cover mb-4">
                        <h5 class="text-lg font-semibold mb-2">{{ product.name }}</h5>

                       <div class="flex justify-center items-center gap-2 mt-2">
                            {% if product.discount %}
                                <p class="line-through text-sm text-gray-500">{{ product.price }} €</p>
                                <p class="text-sm font-semibold text-red-600">{{ product.get_price_with_discount }} €</p>
                            {% else %}
                                <p class="text-sm font-semibold">{{ product.price }} €</p>
                            {% endif %}
                        </div>
                    </a>
                </div>
            {% endfor %}
        </div>
    </section>
</div>
{% endblock content %}